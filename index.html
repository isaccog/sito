<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Un sito isacco - Quadrati Illuminazione f(t)</title>

  <!-- Bootstrap 5 CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet" 
  />
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    html, body {
      margin: 0; 
      padding: 0;
      width: 100%; 
      height: 100%;
      box-sizing: border-box;
    }

    .ring-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      background-color: #fafafa;
      overflow: hidden;
    }

    /* Contenitore generale del quadrato */
    .square {
      position: absolute;
      width: 150px;
      height: 150px;
      border: 2px solid #333;
      box-sizing: border-box;
      opacity: 0.5;
      /* La durata di questa transizione la lasciamo fissa o la possiamo collegare
         a una variabile CSS se vogliamo variare anche la "transizione" in base a f(t).
         Per ora la manteniamo fissa. */
      transition: opacity 0.3s, box-shadow 0.3s;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .square .inner {
      width: 100%;
      height: 100%;
      display: flex;   /* Per centrare il testo */
      justify-content: center;
      align-items: center;
      font: 18px Arial, sans-serif;
      font-weight: bold;
      color: #fff;
    }

    /* Stato "attivo" per illuminarlo */
    .square.active {
      opacity: 1;
      box-shadow: 0 0 30px 4px rgba(255, 255, 255, 0.8);
    }

    /* 
      Distribuiamo i 5 quadrati a cerchio con un raggio di 250px.
      Ognuno ha un'angolazione differente (rotate(angle)). 
      Poi traduciamo di 250px.
      .inner viene ruotato in negativo per mantenere il testo orizzontale.
    */
    .square.s1 {
      background-color: #f00;  /* rosso */
      transform: translate(-50%, -50%)
                 rotate(0deg)
                 translate(250px);
    }
    .square.s1 .inner {
      transform: rotate(-0deg);
    }

    .square.s2 {
      background-color: #0f0;  /* verde */
      transform: translate(-50%, -50%)
                 rotate(72deg)
                 translate(250px);
    }
    .square.s2 .inner {
      transform: rotate(-72deg);
    }

    .square.s3 {
      background-color: #00f;  /* blu */
      transform: translate(-50%, -50%)
                 rotate(144deg)
                 translate(250px);
    }
    .square.s3 .inner {
      transform: rotate(-144deg);
    }

    .square.s4 {
      background-color: #ffa500; /* arancione */
      transform: translate(-50%, -50%)
                 rotate(216deg)
                 translate(250px);
    }
    .square.s4 .inner {
      transform: rotate(-216deg);
    }

    .square.s5 {
      background-color: #800080; /* viola */
      transform: translate(-50%, -50%)
                 rotate(288deg)
                 translate(250px);
    }
    .square.s5 .inner {
      transform: rotate(-288deg);
    }
  </style>
</head>

<body>
  <div id="header"></div>

  <div class="ring-container">
    <div class="square s1"><div class="inner">Cose</div></div>
    <div class="square s2"><div class="inner">Corrosione</div></div>
    <div class="square s3"><div class="inner">Banalità</div></div>
    <div class="square s4"><div class="inner">Assurdità</div></div>
    <div class="square s5"><div class="inner">Cose di cose</div></div>
  </div>

  <script>
    const squares = document.querySelectorAll('.square');
    let currentIndex = 0;

    // Momento di avvio (ms) per calcolare f(t)
    const startTime = performance.now();

    // Definiamo la funzione f(t) => restituisce l'intervallo (in secondi) 
    // tra un'illuminazione e l'altra in funzione del tempo t (in secondi).
    // Esempio: f(t) = 1 + 0.5 * Math.sin(t), giusto per dimostrare un'oscillazione.
    // Se vuoi un altro andamento, personalizza la formula.
    function intervalFunction(t) {
      // Esempio: un valore che oscilla fra 0.5s e 1.5s
      // offset = 1, amplitude = 0.5
      const interval = Math.sin(t*2)/2 + Math.sin(t*2)/2;
      // Non scendere sotto 0.1 secondi di intervallo (es.)
      return Math.max(0.1, Math.abs(interval));
    }

    // Funzione che illumina il prossimo quadrato
    function illuminateNext() {
      // Spegniamo tutti
      squares.forEach(sq => sq.classList.remove('active'));
      // Accendiamo quello corrente
      squares[currentIndex].classList.add('active');
      // Passiamo al prossimo
      currentIndex = (currentIndex + 1) % squares.length;
    }

    // Funzione ricorsiva per gestire la sequenza con setTimeout dinamico
    function loop() {
      // Esegui l'illuminazione
      illuminateNext();

      // Calcola tempo trascorso in secondi
      const now = performance.now();
      const dtSec = (now - startTime) / 1000;

      // Calcola prossimo intervallo in secondi
      const intervalSec = intervalFunction(dtSec);

      // Pianifica il prossimo step dopo intervalSec * 1000 ms
      setTimeout(loop, intervalSec * 1000);
    }

    // Avvio
    loop();

  </script>

  <script>
    // Carichiamo header e footer se presenti
    fetch('header.html')
      .then(resp => resp.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });

    fetch('footer.html')
      .then(resp => resp.text())
      .then(data => {
        document.getElementById('footer').innerHTML = data;
      });
  </script>

  <div id="footer"></div>
</body>
</html>